version: '3.8'

services:
  bot:
    build: 
      context: .
      dockerfile: Dockerfile
    container_name: telegram-bot-dev
    env_file:
      - .env
    environment:
      - ENVIRONMENT=development
      - LOG_LEVEL=DEBUG
    volumes:
      - ./bot:/app/bot  # Mount source code for hot reload
      - ./data:/app/data
      - ./logs:/app/logs
    ports:
      - "8080:8080"  # Health check port
    command: python -m bot.main
    restart: unless-stopped
    networks:
      - bot-network

  # Development Monero wallet (testnet)
  monero-wallet:
    image: sethsimmons/simple-monero-wallet-rpc:latest
    container_name: monero-wallet-dev
    environment:
      - RPC_BIND_IP=0.0.0.0
      - RPC_BIND_PORT=18082
      - DAEMON_ADDRESS=node.moneroworld.com:18089
      - WALLET_FILE=/wallet/dev-wallet
      - WALLET_PASSWORD=development
      - TESTNET=1
    volumes:
      - ./monero-wallet:/wallet
    ports:
      - "18082:18082"
    restart: unless-stopped
    networks:
      - bot-network

networks:
  bot-network:
    driver: bridge